<launch>
    <let name = "urdf_xacro_path" value = "$(find-pkg-share rover_description)/urdf/rover.urdf.xacro" />
    <let name = "world" value = "$(find-pkg-share rover_worlds)/worlds/world.sdf" />
    <let name = "gazebo_config_path" value = "$(find-pkg-share rover_bringup)/config/gazebo_bridge.yaml" />

    <node pkg = "robot_state_publisher" exec = "robot_state_publisher">
        <param name = "use_sim_time" value = "true" />
        <param name = "robot_description" value = "$(command 'xacro $(var urdf_xacro_path)')" />
    </node>

    <include file = "$(find-pkg-share ros_gz_sim)/launch/gz_sim.launch.py">
        <arg name = "gz_args" value = "$(var world) -r" />
    </include>

    <node pkg = "ros_gz_sim" exec = "create" args = "-topic robot_description">
        <param name = "use_sim_time" value = "true" />
    </node>
    <node pkg = "ros_gz_bridge" exec = "parameter_bridge">
        <param name = "use_sim_time" value = "true" />
        <param name = "config_file" value = "$(var gazebo_config_path)" />
    </node>

    <node pkg = "slam_toolbox" exec = "async_slam_toolbox_node" name = "slam_toolbox" output = "screen" args = "--ros-args --params-file $(find-pkg-share rover_bringup)/config/slam_toolbox.yaml">
        <param name = "use_sim_time" value = "true" />
        <!-- <param name = "params_file" value = "$(find-pkg-share rover_bringup)/config/slam_toolbox.yaml" /> -->
    </node>

    <node pkg = "nav2_lifecycle_manager" exec = "lifecycle_manager" name = "lifecycle_manager_slam" output = "screen">
        <param name = "use_sim_time" value = "true" />
        <param name = "autostart" value = "true" />
        <param name = "node_names" value = "['slam_toolbox']" />
    </node>
</launch>